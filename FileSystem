File System in Linux

File system is logical collection of files on partition or disk

It is normal to have n=more than 1 partitions

#partition naming

/dev/xxyN

dev is name of the directory where all device files presents
xx is type of the device on which partition is present hd is for IDE disks and sd is for SCSI disks
y device on which partition is present
N denotes partiotion 1-4 (Primary) >5 (logical)

FIle system/Partition config files

>cat /etc/fstab
LABEL=cloudimg-rootfs   /        ext4   defaults        0 0

list devices
ls /dev


#inode
An inode is a data structure that stores various information about a file in Linux, such as the access mode (read, write, execute permissions), ownership, file type, file size, group, number of links, etc. Each inode is identified by an integer number. An inode is assigned to a file when it is created.

Some file systems (most notably ext3) create all inodes when the file system is created. This means that it is possible to run out of storage because all of the inodes are used, although there is available space on the disk. Other file systems (like xfs) create inodes as needed.

#get inode counts
df -ih

Filesystem     Inodes IUsed IFree IUse% Mounted on
rootfs            999 -976K  977K     - /
none              999 -976K  977K     - /dev

#get inode for file
 ls -il
 
 #get stat about file inode
 
>stat simple.txt
  File: simple.txt
  Size: 70              Blocks: 0          IO Block: 512    regular file
Device: 2h/2d   Inode: 1970324837250862  Links: 1
Access: (0666/-rw-rw-rw-)  Uid: ( 1000/   anand)   Gid: ( 1000/   anand)
Access: 2020-06-09 10:19:05.306685200 +0530
Modify: 2020-06-09 17:01:32.094964700 +0530
Change: 2020-06-09 17:01:32.094964700 +0530
 Birth: -
 
 #inode for directory
ls -ild
2533274790517518 drwxr-xr-x 1 anand anand 512 Jun  9 16:32 .


#There are 3 kind of "timestamps":

Access - the last time the file was read
Modify - the last time the file was modified (content has been modified)
Change - the last time meta data of the file was changed (e.g. permissions)


Last access time
Time when file data last accessed.
Changed by the mknod(2), utimes(2) and read(2) system calls.

Last modified time
Time when file data last modified.
Changed by the mknod(2), utimes(2) and write(2) system calls.

Last changed time
Time when file status was last changed (inode data modification).
Changed by the chmod(2), chown(2), link(2), mknod(2), rename(2), unlink(2), utimes(2) and write(2) system calls.


#create hard link
ln <link_name> <file_name>

#create soft/symbolic link
ln -s <file_name> <link_name>

#remove symbolic links
rm <symbolic_links>
unlink symlink_name


#check files and devices mounted

mount

rootfs on / type lxfs (rw,noatime)
none on /dev type tmpfs (rw,noatime,mode=755)
sysfs on /sys type sysfs (rw,nosuid,nodev,noexec,noatime)
proc on /proc type proc (rw,nosuid,nodev,noexec,noatime)
devpts on /dev/pts type devpts (rw,nosuid,noexec,noatime,gid=5,mode=620)
none on /run type tmpfs (rw,nosuid,noexec,noatime,mode=755)


Some linux group media and devices in /media and /mnt directories

#update partition table
partprobe /dev/sda

######### Mounting Drive Partition #########

sudo mount /dev/sda3 /media/anand


######### Unmount Drive Partition #########

sudo umount /media/anand

#get disks
sudo fdisk -l | grep '/dev/sda*'
Disk /dev/sda: 26 GiB, 27917287424 bytes, 54525952 sectors
/dev/sda1  *        2048  1050623  1048576  512M  b W95 FAT32
/dev/sda2        1052670 41940991 40888322 19.5G  5 Extended
/dev/sda3       41940992 46135295  4194304    2G 83 Linux
/dev/sda5        1052672 41940991 40888320 19.5G 83 Linux


##making file ext4 system 

sudo mkfs.ext4 /dev/sda3

mke2fs 1.45.5 (07-Jan-2020)
/dev/sda3 contains a ext4 file system labelled '2G'
	last mounted on Sat Jun 27 03:26:42 2020
Proceed anyway? (y,N) y
Creating filesystem with 524288 4k blocks and 131072 inodes
Filesystem UUID: 383cd3fa-9484-4599-b2d3-51a948c8dcf9
Superblock backups stored on blocks: 
	32768, 98304, 163840, 229376, 294912

Allocating group tables: done                            
Writing inode tables: done                            
Creating journal (16384 blocks): done
Writing superblocks and filesystem accounting information: done 



